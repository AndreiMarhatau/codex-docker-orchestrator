[Unit]
Description=Codex Orchestrator (update + backend)
After=network-online.target
Wants=network-online.target

[Service]
Type=simple
User=andrei
WorkingDirectory=/home/andrei
Environment=ORCH_PORT=8080
ExecStart=/bin/bash -c 'set -euo pipefail; export PATH=/home/linuxbrew/.linuxbrew/bin:/usr/local/bin:/usr/bin:/bin; cd /home/andrei/codex-docker; git reset --hard; git clean -fd; git pull; cd /home/andrei/codex-docker-orchestrator; git reset --hard; git clean -fd; git pull; cd ui; npm ci; npm run build; cd ../backend; npm ci; exec node src/server.js'
Restart=always
RestartSec=3

[Install]
WantedBy=multi-user.target
